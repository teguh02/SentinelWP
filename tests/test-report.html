<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SentinelWP Test Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        .summary { background: #ecf0f1; padding: 20px; border-radius: 5px; margin: 20px 0; }
        .stats { display: flex; justify-content: space-around; text-align: center; }
        .stat { background: white; padding: 15px; border-radius: 5px; min-width: 120px; }
        .stat-number { font-size: 2em; font-weight: bold; }
        .stat-label { color: #7f8c8d; font-size: 0.9em; }
        .pass { color: #27ae60; }
        .fail { color: #e74c3c; }
        .suite { margin: 30px 0; border: 1px solid #ddd; border-radius: 5px; }
        .suite-header { background: #34495e; color: white; padding: 15px; font-weight: bold; }
        .suite-content { padding: 20px; }
        .test-output { background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 5px; font-family: monospace; font-size: 0.9em; white-space: pre-wrap; max-height: 400px; overflow-y: auto; }
        .timestamp { color: #95a5a6; font-size: 0.9em; }
    </style>
</head>
<body>
    <div class="container">
        <h1>SentinelWP Test Report</h1>
        <p class="timestamp">Generated on 2025-08-20 03:35:42</p>
        
        <div class="summary">
            <div class="stats">
                <div class="stat">
                    <div class="stat-number">54</div>
                    <div class="stat-label">Total Tests</div>
                </div>
                <div class="stat">
                    <div class="stat-number pass">47</div>
                    <div class="stat-label">Passed</div>
                </div>
                <div class="stat">
                    <div class="stat-number fail">7</div>
                    <div class="stat-label">Failed</div>
                </div>
                <div class="stat">
                    <div class="stat-number">0.01s</div>
                    <div class="stat-label">Execution Time</div>
                </div>
                <div class="stat">
                    <div class="stat-number">87%</div>
                    <div class="stat-label">Success Rate</div>
                </div>
            </div>
        </div>
        <div class="suite">
            <div class="suite-header fail">
                ✗ Ai Test Suite
                <span style="float: right; font-weight: normal;">
                    25 tests, 21 passed, 4 failed
                </span>
            </div>
            <div class="suite-content">
                <div class="test-output">Starting SentinelWP AI Recommendations Tests
==================================================
Testing Gemini response parsing...
✓ PASS: Successfully parsed 5 recommendations from gemini-2.5-flash
✗ FAIL: Failed to parse recommendations from gemini-2.5-flash-lite
✗ FAIL: Failed to parse recommendations from gemini-2.5-pro
Testing priority extraction...
✓ PASS: Correctly extracted priority &#039;critical&#039; from: Critical security vulnerability detected
✓ PASS: Correctly extracted priority &#039;high&#039; from: High priority: Update WordPress core
✓ PASS: Correctly extracted priority &#039;medium&#039; from: Medium risk: Configure SSL
✓ PASS: Correctly extracted priority &#039;low&#039; from: Low priority recommendation
✓ PASS: Correctly extracted priority &#039;critical&#039; from: Immediate action required
✓ PASS: Correctly extracted priority &#039;high&#039; from: Important: Enable 2FA
Testing recommendation categorization...
✓ PASS: Correctly categorized: Update WordPress core to latest version -&gt; system_update
✓ PASS: Correctly categorized: Enable two-factor authentication -&gt; access_control
✓ PASS: Correctly categorized: Fix file permissions to 644 -&gt; file_security
✓ PASS: Correctly categorized: Change database table prefix -&gt; database_security
✓ PASS: Correctly categorized: Configure SSL certificate -&gt; ssl_configuration
✗ FAIL: Failed to categorize: Install security monitoring (got general_security, expected monitoring)
Testing confidence score calculation...
✓ PASS: Confidence score for critical priority: 1
✓ PASS: Confidence score for high priority: 0.85
✓ PASS: Confidence score for medium priority: 0.7
✓ PASS: Confidence score for low priority: 0.5
Testing model response differences...
✗ FAIL: gemini-2.5-flash response length unexpected (121 words)
✓ PASS: gemini-2.5-flash-lite provides concise responses (50 words)
✓ PASS: gemini-2.5-pro provides detailed responses (738 words)
Testing error handling...
✓ PASS: Correctly handled empty API response
✓ PASS: Correctly handled malformed JSON
✓ PASS: Correctly handled incomplete response

==================================================
TEST RESULTS SUMMARY
==================================================
Total Tests: 25
Passed: 21
Failed: 4
Success Rate: 84%

FAILED TESTS:
- Failed to parse recommendations from gemini-2.5-flash-lite
- Failed to parse recommendations from gemini-2.5-pro
- Failed to categorize: Install security monitoring (got general_security, expected monitoring)
- gemini-2.5-flash response length unexpected (121 words)

Test completed at 2025-08-20 03:35:42
</div>
            </div>
        </div>
        <div class="suite">
            <div class="suite-header fail">
                ✗ Attack Test Suite
                <span style="float: right; font-weight: normal;">
                    29 tests, 26 passed, 3 failed
                </span>
            </div>
            <div class="suite-content">
                <div class="test-output">Starting SentinelWP Attack Detection Tests
==================================================
Testing brute force attack detection...
✓ PASS: Brute force attack detected after 8 failed attempts
✓ PASS: Distributed brute force attack detected
Testing suspicious activity monitoring...
✓ PASS: Medium threat detected for sensitive file access: wp-config.php
✓ PASS: Medium threat detected for sensitive file access: .htaccess
✓ PASS: High threat detected for malicious file access: /etc/passwd
✓ PASS: SQL injection attempt detected: user=admin&#039;; DROP TABLE users;...
Testing attack threshold calculation...
✓ PASS: Correct threat level calculated: 1
✗ FAIL: Incorrect threat level. Expected: 3, Got: 2
✓ PASS: Correct threat level calculated: 4
Testing attack notification system...
✓ PASS: Attack notification sent successfully
✓ PASS: Email notification triggered
✓ PASS: Email subject contains security alert
✓ PASS: Email contains attack IP address
✓ PASS: Notification rate limiting working correctly
Testing attack status management...
✓ PASS: Attack status set successfully
✓ PASS: Attack status retrieved correctly
✗ FAIL: Attack status should have expired
Testing concurrent attack detection...
✗ FAIL: Failed to detect coordinated attack
Testing attack mitigation measures...
✓ PASS: IP address blocked successfully
✓ PASS: IP blocking verification successful
✓ PASS: Rate limiting applied successfully
✓ PASS: Emergency lockdown activated
✓ PASS: Normal requests blocked during lockdown
Testing false positive handling...
✓ PASS: Correctly identified false positive: wp-config.php access
✓ PASS: Correctly identified false positive: plugin upload
✓ PASS: Correctly identified false positive: database query
✓ PASS: IP 127.0.0.1 correctly whitelisted
✓ PASS: IP 10.0.0.1 correctly whitelisted
✓ PASS: IP 192.168.1.1 correctly whitelisted

==================================================
TEST RESULTS SUMMARY
==================================================
Total Tests: 29
Passed: 26
Failed: 3
Success Rate: 89.66%

FAILED TESTS:
- Incorrect threat level. Expected: 3, Got: 2
- Attack status should have expired
- Failed to detect coordinated attack

Attack Detection Test completed at 2025-08-20 03:35:42
</div>
            </div>
        </div>
    </div>
</body>
</html>